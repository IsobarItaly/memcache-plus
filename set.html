<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="assets/style.css?t=a44c9e9d">
    <script src="assets/script.js?t=820b7ffa"></script>
    <title>Set</title>
    <meta name="viewport" content="width=device-width">
  </head>
  <body class="-menu-visible">
    <div class="doc-layout">
      <div class="toggle menu-toggle js-menu-toggle"></div>
      <div class="body page-set">
        <div class="header-nav">
          <div class="right">
          </div>
        </div>
        <div class="markdown-body"><h1 id="set">Set</h1>
<h3 id="basic-case">Basic case</h3>
<p>After you&apos;ve created a client (which will automatically establish a connection),
you can start issuing commands! The most basic is to set a value:</p>
<pre><code class="lang-javascript">client
    .set(<span class="pl-s">&apos;firstName&apos;</span>, <span class="pl-s">&apos;Victor&apos;</span>)
    .then(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Successfully set the key firstName&apos;</span>);
    });
</code></pre>
<h3 id="arguments">Arguments</h3>
<p><code>set()</code> requires 2 arguments and could have up to 4.</p>
<p>The first is always the key and must be a string.<br>
The second is always the value and must be a string.<br>
The third is optional and could be either: (1) a ttl for this key (2) an options object or (3) a callback<br>
The fourth is only present if there is a third argument for ttl or options and a callback is provided.</p>
<h3 id="key-must-be-a-string">Key must be a string</h3>
<p>Non-string keys are not allowed and Memcache Plus will throw an error if you
try to provide a non-string key.</p>
<pre><code class="lang-javascript">client
    .set({ foo: <span class="pl-s">&apos;bar&apos;</span> }, myVal)
    .then(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="pl-c">// This will never happen because an error will be thrown</span>
    })
    .catch(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params">err</span>) </span>{
        <span class="pl-c">// This will get hit!</span>
        <span class="pl-c1">console</span>.error(<span class="pl-s">&apos;Oops we have an error&apos;</span>, err);
    });
</code></pre>
<h3 id="value-can-be-of-any-type">Value can be of any type</h3>
<p>The value can be of any type (numeric, string, object, array, null, etc.)</p>
<p>Memcache Plus will handle converting the value (if necessary) before sending to
the Memcached server and converting it back upon retrieval.</p>
<p>For instance, with Memcache Plus you can go ahead and set an object</p>
<pre><code class="lang-javascript"><span class="pl-k">var</span> myVal = {
    firstName: <span class="pl-s">&apos;Victor&apos;</span>,
    lastName: <span class="pl-s">&apos;Quinn&apos;</span>
};

client
    .set(<span class="pl-s">&apos;user&apos;</span>, myVal)
    .then(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Successfully set the object&apos;</span>);
    });
</code></pre>
<p>Then when you get it out it&apos;ll be an object:</p>
<pre><code class="lang-javascript">client
    .get(<span class="pl-s">&apos;user&apos;</span>)
    .then(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params">user</span>) </span>{
        <span class="pl-c">// The user is a JS object:</span>
        <span class="pl-c">// { firstName: &apos;Victor&apos;, lastName: &apos;Quinn&apos; }</span>
        <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Successfully got the object&apos;</span>, user);
    });
</code></pre>
<p>Same goes for numbers, arrays, etc. Memcache Plus will always return the exact
type you put into it.</p>
<h3 id="ttl">TTL</h3>
<p>A key/value pair can be specified with an optional ttl which will specify how
long (in seconds) that object persists before it is automatically purged from the cache.</p>
<p>For example, to set a value that will stay around in the cache for only 10 seconds:</p>
<pre><code class="lang-javascript">client.set(<span class="pl-s">&apos;firstName&apos;</span>, <span class="pl-s">&apos;Victor&apos;</span>, <span class="hljs-number">10</span>);
</code></pre>
<p>If you perform a <code>get()</code> within 10 seconds for <code>firstName</code>, you&apos;ll get back
<code>&quot;Victor&quot;</code> but after 10 seconds, you will get <code>null</code>.</p>
<h3 id="callbacks">Callbacks</h3>
<p>Memcache Plus will always return a <a href="https://www.promisejs.org">Promise</a>, but it
can also take a traditional callback for any of its methods so it can work just
like most of the other Memcache modules out there. For example:</p>
<pre><code class="lang-javascript">client.set(<span class="pl-s">&apos;firstName&apos;</span>, <span class="pl-s">&apos;Victor&apos;</span>, <span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params">err</span>) </span>{
    <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Successfully set the key firstName&apos;</span>);
});
</code></pre>
<h3 id="compression">Compression</h3>
<p>Optionally you can request that compression be enabled for a given item:</p>
<pre><code class="lang-javascript">client.set(<span class="pl-s">&apos;firstName&apos;</span>, <span class="pl-s">&apos;Victor&apos;</span>, { compressed: <span class="pl-c1">true</span> })
    .then(<span class="hljs-function"><span class="pl-k">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="pl-c1">console</span>.log(<span class="pl-s">&apos;Successfully set the key firstName as compressed data&apos;</span>);
    });
</code></pre>
<p>By enabling this option, every key will be compressed with Node&apos;s
<a href="https://nodejs.org/api/zlib.html">zlib</a> library prior to being stored.</p>
<p>This is helpful in the event that you are attempting to store data (such as a
stringified object) which is too large for the standard Memcache value limit
size. It is also helpful in situations where the memory allocated to your
Memcache instance is limited, such as on a Raspberry Pi or some other embedded
hardware.</p>
<p>For example, if your Memcache server is set with a limit of 1MB for a value and
you attempt to store a 1.2MB object, the set will fail. However, enabling
compression will cause the value to be compressed with zlib before it is stored
so the size may be reduced significantly and save successfully.</p>
<p>Notes:</p>
<ol>
<li>If you store a value compressed with <code>set()</code> you have to <code>get()</code> it and
specify that it was compressed. There is no automatic inspection of values to
determine whether they were set with compression and decompress automatically
(as this would incur significant performance penalty)</li>
<li>Enabling compression will reduce the size of the objects stored but it will
also add a non-negligent performance hit to each <code>set()</code> and <code>get()</code> so use it
judiciously!</li>
<li>The maximum key size is 250 bytes. This is a Memcache limitation and this
library will throw an error if a key larger than that is provided.</li>
</ol>
<h3 id="errors">Errors</h3>
<p>Memcache Plus will throw errors for any unexpected or broken behavior so you
know quickly if something is wrong with your application. These could be things
like: trying to <code>set()</code> an item without a key, trying to <code>set()</code> an item that
is too large, trying to <code>set()</code> with a key that is too long, and many more.</p>

        </div>
        <div class="footer-nav">
          <div class="left"><a href="initialization.html"><span class="title">Initialization</span></a></div>
          <div class="right"><a href="get.html"><span class="label">Next: </span><span class="title">Get</span></a></div>
        </div>
      </div>
      <div class="menu toc-menu">
        <li class="menu-item -level-0 -parent">
          <ul class="submenu">
            <li class="menu-item -level-1 -parent"><a href="index.html" class="link title  link-index">Memcache Plus</a>
              <ul class="submenu">
                <li class="menu-item -level-2"><a href="intro.html" class="link title  link-intro">Getting Started</a>
                </li>
                <li class="menu-item -level-2"><a href="initialization.html" class="link title  link-initialization">Initialization</a>
                </li>
                <li class="menu-item -level-2"><a href="set.html" class="link title -active link-set">Set</a>
                  <ul class="headings heading-list">
                    <li class="heading-item -depth-3"><a href="#basic-case" class="hlink link-basic-case">Basic case</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#arguments" class="hlink link-arguments">Arguments</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#key-must-be-a-string" class="hlink link-key-must-be-a-string">Key must be a string</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#value-can-be-of-any-type" class="hlink link-value-can-be-of-any-type">Value can be of any type</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#ttl" class="hlink link-ttl">TTL</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#callbacks" class="hlink link-callbacks">Callbacks</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#compression" class="hlink link-compression">Compression</a>
                    </li>
                    <li class="heading-item -depth-3"><a href="#errors" class="hlink link-errors">Errors</a>
                    </li>
                  </ul>
                </li>
                <li class="menu-item -level-2"><a href="get.html" class="link title  link-get">Get</a>
                </li>
                <li class="menu-item -level-2"><a href="getmulti.html" class="link title  link-getmulti">Get Multi</a>
                </li>
                <li class="menu-item -level-2"><a href="delete.html" class="link title  link-delete">Delete</a>
                </li>
                <li class="menu-item -level-2"><a href="incrdecr.html" class="link title  link-incrdecr">Incr/Decr</a>
                </li>
                <li class="menu-item -level-2"><a href="appendprepend.html" class="link title  link-appendprepend">Append/Prepend</a>
                </li>
                <li class="menu-item -level-2"><a href="add.html" class="link title  link-add">Add</a>
                </li>
                <li class="menu-item -level-2"><a href="replace.html" class="link title  link-replace">Replace</a>
                </li>
                <li class="menu-item -level-2"><a href="flush.html" class="link title  link-flush">Flush</a>
                </li>
                <li class="menu-item -level-2"><a href="items.html" class="link title  link-items">Items</a>
                </li>
                <li class="menu-item -level-2"><a href="disconnect.html" class="link title  link-disconnect">Disconnect</a>
                </li>
                <li class="menu-item -level-2"><a href="elasticache.html" class="link title  link-elasticache">Elasticache</a>
                </li>
                <li class="menu-item -level-2"><a href="misc.html" class="link title  link-misc">Miscellaneous</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </div>
    </div>
  </body>
</html>